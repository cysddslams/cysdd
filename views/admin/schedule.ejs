<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Home - SLAMS</title>
    <link rel="stylesheet" href="/styles/adminHome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
    /* Enhanced Color Scheme with Better Contrast */
    :root {
        --primary-blue: #2563eb;
        --primary-dark: #1d4ed8;
        --primary-light: #3b82f6;
        --secondary-blue: #1e40af;
        --success-green: #10b981;
        --warning-orange: #f59e0b;
        --danger-red: #ef4444;
        --info-cyan: #06b6d4;
        --dark-text: #1f2937;
        --medium-text: #4b5563;
        --light-text: #6b7280;
        --bg-white: #ffffff;
        --bg-light: #f8fafc;
        --bg-gray: #f1f5f9;
        --border-light: #e5e7eb;
        --border-medium: #d1d5db;
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    /* Base Styles */
    body {
        font-family: 'Poppins', sans-serif;
        background: var(--bg-light);
        color: var(--dark-text);
        line-height: 1.6;
    }

    .schedule-container {
        padding: 24px;
        max-width: 1400px;
        margin: 0 auto;
        min-height: 100vh;
        transition: margin-left 0.3s ease;
    }

    /* Typography with Better Contrast */
    .schedule-container h2 {
        color: var(--dark-text) !important;
        font-weight: 700;
        font-size: 2.5rem;
        margin-bottom: 32px;
        padding-bottom: 16px;
        border-bottom: 3px solid var(--primary-blue);
        position: relative;
        text-align: center;
    }

    .schedule-container h2:after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 3px;
        background: linear-gradient(90deg, var(--primary-blue), var(--info-cyan));
    }

    .schedule-container h3 {
        color: var(--dark-text) !important;
        font-weight: 600;
        font-size: 1.75rem;
        margin-bottom: 24px;
        padding-left: 16px;
        border-left: 4px solid var(--primary-blue);
    }

    .schedule-container h4 {
        color: var(--dark-text) !important;
        font-weight: 600;
        font-size: 1.4rem;
        margin-bottom: 20px;
    }

    .schedule-container h5 {
        color: var(--dark-text) !important;
        font-weight: 600;
        font-size: 1.2rem;
        margin-bottom: 16px;
    }

    .schedule-container p {
        color: var(--medium-text) !important;
        margin-bottom: 12px;
        line-height: 1.7;
    }

    /* Events Section */
    .events-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 24px;
        margin-bottom: 40px;
    }

    .event-card {
        background: var(--bg-white);
        border-radius: 16px;
        padding: 28px;
        box-shadow: var(--shadow-md);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid var(--border-light);
        position: relative;
        overflow: hidden;
    }

    .event-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 6px;
        height: 100%;
        background: linear-gradient(to bottom, var(--primary-blue), var(--info-cyan));
    }

    .event-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
        border-color: var(--primary-blue);
    }

    .event-card h4 {
        color: var(--dark-text) !important;
        margin-bottom: 16px;
        font-size: 1.4rem;
        font-weight: 700;
    }

    .event-card p {
        color: var(--medium-text) !important;
        margin: 10px 0;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.95rem;
    }

    .event-card i {
        color: var(--primary-blue);
        width: 18px;
        font-size: 1.1rem;
    }

    /* Sports Section */
    .sports-section, .teams-section, .bracket-section, .matches-section, .ai-recommendation-section {
        display: none;
        margin-top: 32px;
        background: var(--bg-white);
        padding: 32px;
        border-radius: 16px;
        box-shadow: var(--shadow-md);
        border: 1px solid var(--border-light);
    }

    .sports-grid, .teams-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 20px;
        margin: 24px 0;
    }

    .sport-card, .team-card {
        background: var(--bg-gray);
        padding: 24px 20px;
        border-radius: 12px;
        text-align: center;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
    }

    .sport-card:hover, .team-card:hover {
        background: #e0f2fe;
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary-blue);
    }

    .sport-card.selected, .team-card.selected {
        border-color: var(--primary-blue);
        background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
        box-shadow: 0 8px 25px rgba(37, 99, 235, 0.2);
    }

    .sport-card h5, .team-card h5 {
        color: var(--dark-text) !important;
        margin-bottom: 12px;
        font-size: 1.2rem;
        font-weight: 600;
    }

    .sport-card small, .team-card p {
        color: var(--medium-text) !important;
        font-size: 0.9rem;
    }

    /* Sport Category Groups */
    .sport-category-group {
        background: linear-gradient(135deg, var(--bg-gray) 0%, #e2e8f0 100%);
        border: 1px solid var(--border-medium);
        border-radius: 14px;
        padding: 24px;
        margin-bottom: 28px;
        box-shadow: var(--shadow-sm);
    }

    .sport-category-group h5 {
        color: var(--dark-text) !important;
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 18px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--primary-blue);
        text-align: center;
    }

    /* AI Recommendation Section */
    .ai-recommendation-section {
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        border: 2px solid var(--primary-blue);
        border-left: 8px solid var(--primary-blue);
    }

    .ai-recommendation-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 28px;
        padding-bottom: 20px;
        border-bottom: 2px solid var(--primary-blue);
    }

    .ai-recommendation-header h3 {
        color: var(--dark-text) !important;
        margin: 0;
        font-size: 1.8rem;
    }

    .ai-recommendation-header .ai-icon {
        font-size: 2.2rem;
        color: var(--primary-blue);
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: var(--shadow-md);
    }

    .ai-recommendation-content {
        padding: 24px;
        background: var(--bg-white);
        border-radius: 12px;
        box-shadow: var(--shadow-sm);
    }

    .recommendation-card {
        border: 2px solid;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        transition: all 0.3s ease;
    }

    .recommendation-card.recommended {
        border-color: var(--success-green);
        background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }

    .recommendation-card.alternative {
        border-color: var(--warning-orange);
        background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
    }

    .recommendation-card.not-recommended {
        border-color: var(--danger-red);
        background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    }

    .recommendation-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 18px;
    }

    .recommendation-badge {
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 700;
        font-size: 0.9rem;
        color: white;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .recommendation-badge.recommended {
        background: var(--success-green);
    }

    .recommendation-badge.alternative {
        background: var(--warning-orange);
        color: var(--dark-text);
    }

    .recommendation-badge.not-recommended {
        background: var(--danger-red);
    }

    .confidence-badge {
        background: var(--primary-blue);
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .recommendation-details p {
        color: var(--medium-text) !important;
        margin: 10px 0;
        font-size: 1rem;
    }

    .recommendation-stats {
        background: var(--bg-gray);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        border-left: 5px solid var(--primary-blue);
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 20px;
        margin-top: 15px;
    }

    .stat-item {
        text-align: center;
        padding: 16px;
        background: var(--bg-white);
        border-radius: 8px;
        border: 1px solid var(--border-light);
        box-shadow: var(--shadow-sm);
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 800;
        color: var(--primary-blue);
        margin-bottom: 8px;
    }

    .stat-label {
        font-size: 0.95rem;
        color: var(--medium-text) !important;
        font-weight: 500;
    }

    /* Warning Alert */
    .warning-alert {
        background: #fffbeb;
        border: 1px solid var(--warning-orange);
        color: #92400e;
        padding: 16px 20px;
        border-radius: 10px;
        margin: 18px 0;
        font-size: 0.95rem;
        display: flex;
        align-items: flex-start;
        gap: 12px;
    }

    .warning-alert i {
        color: var(--warning-orange);
        font-size: 1.2rem;
        margin-top: 2px;
    }

    /* Buttons - Enhanced Contrast */
    .btn {
        padding: 14px 28px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 15px;
        font-weight: 600;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        min-width: 140px;
        box-shadow: var(--shadow-md);
    }

    .btn:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
    }

    .btn:active {
        transform: translateY(-1px);
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary-blue), var(--primary-dark));
        color: white;
    }

    .btn-primary:hover {
        background: linear-gradient(135deg, var(--primary-dark), var(--secondary-blue));
    }

    .btn-success {
        background: linear-gradient(135deg, var(--success-green), #059669);
        color: white;
    }

    .btn-success:hover {
        background: linear-gradient(135deg, #059669, #047857);
    }

    .btn-secondary {
        background: linear-gradient(135deg, #6b7280, #4b5563);
        color: white;
    }

    .btn-secondary:hover {
        background: linear-gradient(135deg, #4b5563, #374151);
    }

    .btn-info {
        background: linear-gradient(135deg, var(--info-cyan), #0891b2);
        color: white;
    }

    .btn-info:hover {
        background: linear-gradient(135deg, #0891b2, #0e7490);
    }

    .btn-warning {
        background: linear-gradient(135deg, var(--warning-orange), #d97706);
        color: var(--dark-text);
    }

    .btn-warning:hover {
        background: linear-gradient(135deg, #d97706, #b45309);
    }

    .btn-ai {
        background: linear-gradient(135deg, #8b5cf6, var(--primary-blue));
        color: white;
    }

    .btn-ai:hover {
        background: linear-gradient(135deg, var(--primary-blue), #7c3aed);
    }

    /* Alerts */
    .alert {
        padding: 18px 24px;
        border-radius: 12px;
        margin-bottom: 24px;
        font-weight: 500;
        border: 1px solid;
        display: flex;
        align-items: center;
        gap: 12px;
        box-shadow: var(--shadow-sm);
    }

    .alert-success {
        background: linear-gradient(135deg, #d1fae5, #a7f3d0);
        border-color: var(--success-green);
        color: #065f46;
    }

    .alert-danger {
        background: linear-gradient(135deg, #fee2e2, #fecaca);
        border-color: var(--danger-red);
        color: #991b1b;
    }

    /* Bracket Section */
    .bracket-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 24px;
        margin: 24px 0;
    }

    .bracket-option {
        padding: 32px 24px;
        background: var(--bg-gray);
        border-radius: 14px;
        text-align: center;
        cursor: pointer;
        border: 3px solid transparent;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
    }

    .bracket-option:hover {
        background: #e0f2fe;
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary-blue);
    }

    .bracket-option.selected {
        border-color: var(--primary-blue);
        background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
        box-shadow: 0 10px 30px rgba(37, 99, 235, 0.2);
    }

    .bracket-option h4 {
        color: var(--dark-text) !important;
        margin-bottom: 14px;
        font-size: 1.3rem;
    }

    .bracket-option p {
        color: var(--medium-text) !important;
        font-size: 0.95rem;
        line-height: 1.6;
    }

    /* Matches Section */
    .matches-container {
        margin-top: 32px;
    }

    .round {
        margin-bottom: 40px;
    }

    .round-header {
        background: linear-gradient(135deg, var(--primary-blue), var(--info-cyan));
        color: white;
        padding: 20px 32px;
        border-radius: 12px;
        margin-bottom: 28px;
        font-weight: 700;
        font-size: 1.3rem;
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .match-card {
        background: var(--bg-white);
        border: 1px solid var(--border-light);
        border-radius: 14px;
        padding: 28px;
        margin-bottom: 28px;
        box-shadow: var(--shadow-md);
        transition: all 0.3s ease;
        position: relative;
    }

    .match-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-3px);
        border-color: var(--primary-blue);
    }

    .teams-display {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding: 20px;
        background: var(--bg-gray);
        border-radius: 12px;
        border: 1px solid var(--border-medium);
    }

    .team {
        flex: 1;
        text-align: center;
        padding: 16px;
        font-weight: 700;
        color: var(--dark-text) !important;
        font-size: 1.2rem;
        background: white;
        border-radius: 8px;
        margin: 0 8px;
        box-shadow: var(--shadow-sm);
    }

    .vs {
        margin: 0 20px;
        font-weight: 800;
        color: var(--primary-blue) !important;
        background: white;
        padding: 10px 20px;
        border-radius: 25px;
        border: 2px solid var(--primary-blue);
        font-size: 1rem;
        min-width: 60px;
        text-align: center;
    }

    .match-actions {
        display: flex;
        gap: 16px;
        margin-top: 24px;
        padding-top: 24px;
        border-top: 1px solid var(--border-light);
        flex-wrap: wrap;
    }

    /* AI Team Selection */
    .ai-team-selection {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 24px 0;
        padding: 24px;
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        border-radius: 14px;
        border: 2px solid var(--primary-blue);
        box-shadow: var(--shadow-md);
    }

    .ai-team-selection-info h4 {
        color: var(--dark-text) !important;
        margin: 0 0 8px 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .ai-team-selection-info p {
        color: var(--medium-text) !important;
        margin: 4px 0;
    }

    .ai-team-selection-actions {
        display: flex;
        gap: 16px;
    }

    /* Complexity Indicators */
    .complexity-low { color: var(--success-green) !important; font-weight: 700; }
    .complexity-medium { color: var(--warning-orange) !important; font-weight: 700; }
    .complexity-high { color: #f97316 !important; font-weight: 700; }
    .complexity-very-high { color: var(--danger-red) !important; font-weight: 700; }

    /* Match Comparison Table */
    .match-comparison {
        margin: 28px 0;
        background: white;
        padding: 24px;
        border-radius: 12px;
        box-shadow: var(--shadow-sm);
    }

    .match-comparison table {
        width: 100%;
        border-collapse: collapse;
        margin: 16px 0;
    }

    .match-comparison th {
        background: var(--primary-blue);
        color: white;
        padding: 16px 20px;
        text-align: left;
        font-weight: 600;
        font-size: 1rem;
    }

    .match-comparison td {
        padding: 14px 20px;
        border-bottom: 1px solid var(--border-light);
        color: var(--medium-text);
        font-weight: 500;
    }

    .match-comparison tr:hover {
        background: var(--bg-gray);
    }

    .match-comparison tr:nth-child(2) {
        background: #f0fdf4;
        border-left: 4px solid var(--success-green);
    }

    /* Modals */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(8px);
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    .modal-content {
        background-color: var(--bg-white);
        margin: 5% auto;
        padding: 40px;
        border-radius: 20px;
        width: 90%;
        max-width: 500px;
        box-shadow: var(--shadow-xl);
        position: relative;
        animation: modalSlideIn 0.4s ease;
    }

    @keyframes modalSlideIn {
        from { opacity: 0; transform: translateY(-30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .modal-content h3 {
        color: var(--dark-text) !important;
        margin-bottom: 28px;
        font-size: 1.6rem;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--primary-blue);
    }

    .form-group {
        margin-bottom: 28px;
    }

    .form-group label {
        display: block;
        margin-bottom: 12px;
        font-weight: 600;
        color: var(--dark-text) !important;
        font-size: 1rem;
    }

    .form-group input, .form-group select {
        width: 100%;
        padding: 16px;
        border: 2px solid var(--border-light);
        border-radius: 10px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: var(--bg-white);
        color: var(--dark-text);
    }

    .form-group input:focus, .form-group select:focus {
        outline: none;
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
    }

    .form-actions {
        display: flex;
        gap: 16px;
        justify-content: flex-end;
        margin-top: 32px;
    }

    /* Existing Brackets */
    .existing-brackets {
        margin: 24px 0;
        padding: 28px;
        background: linear-gradient(135deg, #eff6ff, #dbeafe);
        border-radius: 14px;
        border-left: 6px solid var(--primary-blue);
        box-shadow: var(--shadow-sm);
    }

    .bracket-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .bracket-item {
        background: white;
        padding: 24px;
        border-radius: 12px;
        border: 2px solid var(--border-light);
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
    }

    .bracket-item:hover {
        border-color: var(--primary-blue);
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
    }

    .bracket-item h5 {
        color: var(--dark-text) !important;
        margin-bottom: 12px;
        font-size: 1.1rem;
    }

    .bracket-item p {
        color: var(--medium-text) !important;
        margin: 8px 0;
        font-size: 0.9rem;
    }

    /* Debug Tools */
    .debug-tools {
        margin-top: 32px;
        padding: 24px;
        background: linear-gradient(135deg, #fffbeb, #fef3c7);
        border-radius: 14px;
        border-left: 6px solid var(--warning-orange);
        box-shadow: var(--shadow-sm);
    }

    .debug-tools h4 {
        color: var(--dark-text) !important;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    /* AI Loading */
    .ai-loading {
        text-align: center;
        padding: 60px 40px;
    }

    .ai-loading .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--bg-gray);
        border-top: 4px solid var(--primary-blue);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 24px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Badminton-specific styles */
    .sport-card.badminton {
        background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
        border: 2px solid #38bdf8;
    }

    .sport-card.badminton.selected {
        background: linear-gradient(135deg, #bae6fd 0%, #7dd3fc 100%);
        border: 3px solid var(--primary-blue);
        box-shadow: 0 10px 30px rgba(25, 118, 210, 0.3);
    }

    .sport-card.badminton h5 {
        color: var(--secondary-blue) !important;
    }

    .category-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
        margin-top: 8px;
        color: white;
    }

    .category-singles {
        background: var(--success-green);
    }

    .category-doubles {
        background: var(--warning-orange);
    }

    /* Form Controls */
    .form-control {
        background: var(--bg-white);
        border: 2px solid var(--border-light);
        color: var(--dark-text);
    }

    .form-control:focus {
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
    }

    /* Scrollbar Styling */
    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
    }

    ::-webkit-scrollbar-track {
        background: var(--bg-gray);
        border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb {
        background: var(--primary-light);
        border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-blue);
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .schedule-container {
            padding: 20px;
        }
        
        .events-grid,
        .bracket-list {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }
    }

    @media (max-width: 992px) {
        .schedule-container h2 {
            font-size: 2rem;
        }
        
        .schedule-container h3 {
            font-size: 1.5rem;
        }
        
        .sports-grid,
        .teams-grid,
        .bracket-options {
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }
        
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .schedule-container {
            padding: 16px;
            margin-left: 0 !important;
        }
        
        .events-grid,
        .sports-grid,
        .teams-grid,
        .bracket-options,
        .bracket-list,
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .teams-display {
            flex-direction: column;
            gap: 16px;
        }
        
        .vs {
            margin: 10px 0;
            transform: rotate(0deg);
        }
        
        .match-actions,
        .recommendation-actions,
        .ai-team-selection,
        .ai-team-selection-actions,
        .form-actions {
            flex-direction: column;
        }
        
        .btn {
            width: 100%;
            max-width: 100%;
        }
        
        .schedule-container h2 {
            font-size: 1.8rem;
            padding: 0 16px 16px;
        }
        
        .schedule-container h3 {
            font-size: 1.4rem;
        }
        
        .modal-content {
            padding: 30px 24px;
            margin: 10% auto;
            width: 95%;
        }
        
        .ai-team-selection {
            flex-direction: column;
            gap: 20px;
            text-align: center;
        }
        
        .sports-section,
        .teams-section,
        .bracket-section,
        .matches-section,
        .ai-recommendation-section {
            padding: 24px 20px;
            margin-top: 24px;
        }
    }

    @media (max-width: 480px) {
        .schedule-container {
            padding: 12px;
        }
        
        .schedule-container h2 {
            font-size: 1.6rem;
        }
        
        .schedule-container h3 {
            font-size: 1.3rem;
            padding-left: 12px;
        }
        
        .event-card,
        .match-card,
        .recommendation-card {
            padding: 20px;
        }
        
        .round-header {
            padding: 16px 20px;
            font-size: 1.1rem;
        }
        
        .modal-content {
            padding: 24px 20px;
        }
    }

    /* Print Styles */
    @media print {
        .schedule-container {
            padding: 0;
            max-width: none;
        }
        
        .btn,
        .match-actions,
        .debug-tools,
        .ai-team-selection-actions {
            display: none !important;
        }
        
        .event-card,
        .match-card,
        .recommendation-card {
            break-inside: avoid;
            box-shadow: none;
            border: 1px solid #ccc;
        }
    }

    /* Accessibility Improvements */
    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    /* Focus styles for keyboard navigation */
    button:focus-visible,
    input:focus-visible,
    select:focus-visible,
    .event-card:focus-visible,
    .sport-card:focus-visible,
    .team-card:focus-visible {
        outline: 3px solid var(--primary-blue);
        outline-offset: 3px;
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.3);
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
        :root {
            --primary-blue: #0056b3;
            --dark-text: #000000;
            --medium-text: #333333;
        }
        
        .btn,
        .event-card,
        .match-card {
            border-width: 2px;
        }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        
        .modal-content {
            animation: none;
        }
        
        .ai-loading .spinner {
            animation: none;
            border: 4px solid var(--border-light);
            border-top: 4px solid var(--primary-blue);
        }
    }
    </style>
</head>
<body>
    <!-- Sidebar Menu -->
    <div id="mySidebar" class="sidebar">
        <a href="/admin/home" class="active"><i class="fas fa-home"></i> Home</a>
        <a href="/admin/posts" ><i class="fas fa-newspaper"></i> Posts</a>
        <a href="/admin/events"><i class="fas fa-calendar-alt"></i> Events</a>
        <a href="/admin/schedule"><i class="fas fa-calendar-day"></i> Schedule</a>
        <a href="/admin/coach"><i class="fas fa-chalkboard-teacher"></i> Coordinator Request</a>
        <!-- Team dropdown section -->
        <a href="javascript:void(0);" class="team-dropdown-btn"><i class="fas fa-users-cog"></i> Teams</a>
        <div class="team-dropdown-content">
            <a href="/admin/team-request"><i class="fas fa-users"></i> Team Request</a>
            <a href="/admin/registered-team"><i class="fas fa-landmark"></i> All Team</a>
        </div>
        <a href="/admin/users"><i class="fas fa-users"></i> Players</a>
        <a href="/admin/all-users"><i class="fas fa-user-friends"></i> Users</a>
        <a href="/admin/event-history"><i class="fas fa-history"></i> Event History</a>
    </div>
    <!-- Sidebar toggle button -->
    <span class="sidebar-btn" onclick="toggleNav()">&#9776;</span>
    
    <header class="header" style="display: flex; justify-content: space-between; align-items: center;">
        <div class="logo">
            <a href="/admin/home" style="text-decoration: none;">
                <img src="/images/cityYouth.jpg" alt="SLAMS Logo">
            </a>
            <span class="slams-title">CYSDD</span>
        </div>
        <!-- Container for bell and user profile -->
        <div style="display: flex; align-items: center; gap: 20px;">
            <!-- Admin Profile -->
            <div class="user-profile" style="position: relative;" id="adminProfileContainer">
                <% if (admin && admin.profilePic) { %>
                    <img src="<%= admin.profilePic %>" 
                        alt="Admin Profile" 
                        style="width: 35px; height: 35px; border-radius: 50%; border: 2px solid #007bff; object-fit: cover;">
                <% } else { %>
                    <i class="fas fa-user-shield" style="font-size: 22px; color: white;"></i>
                <% } %>
                <div class="dropdown-content" id="adminDropdownMenu" style="display: none;">
                    <a href="/admin/adminProfile">
                        <i class="fas fa-cogs" style="margin-right: 8px;"></i> Admin
                    </a>
                    <a href="javascript:void(0);" class="logout-btn" onclick="showLogoutModal()">
                        <i class="fas fa-sign-out-alt" style="margin-right: 8px;"></i> Log Out
                    </a>
                </div>
            </div>
        </div>
    </header>
                
    <main class="schedule-container">
        <h2>Tournament Schedule Management</h2>
        
        <!-- Success/Error Messages -->
        <% if (success && success.length > 0) { %>
            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i> <%= success %>
            </div>
        <% } %>
        <% if (error && error.length > 0) { %>
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-triangle"></i> <%= error %>
            </div>
        <% } %>

        <!-- Events Section -->
        <section id="eventsSection">
            <h3>Select an Event</h3>
            <div class="events-grid" id="eventsGrid">
                <% events.forEach(event => { %>
                    <div class="event-card" data-event-id="<%= event.id %>" data-event-title="<%= event.title %>" tabindex="0">
                        <h4><%= event.title %></h4>
                        <p><i class="fas fa-calendar-alt"></i> <%= event.date_schedule %></p>
                        <p><i class="fas fa-map-marker-alt"></i> <%= event.location %></p>
                        <p style="margin-top: 12px; color: var(--primary-blue); font-weight: 600;">
                            <i class="fas fa-arrow-right"></i> Click to select
                        </p>
                    </div>
                <% }); %>
            </div>
        </section>

        <!-- Sports Section -->
        <section id="sportsSection" class="sports-section">
            <h3>Select Sport Type for <span id="selectedEventTitle" style="color: var(--primary-blue);"></span></h3>
            <div class="sports-grid" id="sportsGrid"></div>
        </section>

        <!-- AI Recommendation Section -->
        <section id="aiRecommendationSection" class="ai-recommendation-section" style="display: none;">
            <div class="ai-recommendation-header">
                <div class="ai-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div>
                    <h3>ðŸ¤– AI Tournament Format Assistant</h3>
                    <p style="color: var(--medium-text); margin: 4px 0 0 0; font-size: 0.95rem;">
                        Smart recommendations based on team count and historical data
                    </p>
                </div>
            </div>
            <div class="ai-recommendation-content">
                <div id="aiLoading" class="ai-loading">
                    <div class="spinner"></div>
                    <p style="font-size: 1.1rem; color: var(--dark-text); font-weight: 600;">
                        AI is analyzing tournament data...
                    </p>
                    <p style="color: var(--medium-text); margin-top: 8px;">
                        Calculating optimal format based on team selection and historical patterns
                    </p>
                </div>
                <div id="aiRecommendationContent" style="display: none;">
                    <!-- AI recommendations will be displayed here -->
                </div>
            </div>
        </section>

        <!-- Teams Section -->
        <section id="teamsSection" class="teams-section">
            <h3>Select Teams for <span id="selectedSportTitle" style="color: var(--primary-blue);"></span></h3>
            
            <!-- AI Team Selection Assistant -->
            <div id="aiTeamSelectionSection" class="ai-team-selection" style="display: none;">
                <div class="ai-team-selection-info">
                    <h4><i class="fas fa-robot"></i> AI Tournament Assistant</h4>
                    <p>Selected <strong style="color: var(--primary-blue);"><span id="aiTeamCount">0</span></strong> teams for tournament</p>
                    <p style="font-size: 0.9rem; color: var(--light-text);">
                        AI will analyze your selection and recommend the best tournament format
                    </p>
                </div>
                <div class="ai-team-selection-actions">
                    <button id="getAIRecommendation" class="btn btn-ai">
                        <i class="fas fa-magic"></i> Get AI Recommendation
                    </button>
                    <button id="proceedWithoutAI" class="btn btn-secondary">
                        <i class="fas fa-forward"></i> Skip AI
                    </button>
                </div>
            </div>
            
            <div id="existingBracketsSection" class="existing-brackets" style="display: none;">
                <h4><i class="fas fa-trophy"></i> Existing Tournament Brackets</h4>
                <p style="color: var(--medium-text); margin-bottom: 20px;">
                    Select an existing bracket or create a new one
                </p>
                <div id="bracketList" class="bracket-list"></div>
                <div style="margin-top: 24px; text-align: center;">
                    <button id="createNewBracket" class="btn btn-info">
                        <i class="fas fa-plus"></i> Create New Bracket
                    </button>
                </div>
            </div>
            <div id="teamsSelectionSection">
                <p style="color: var(--medium-text); margin-bottom: 20px;">
                    Select teams by clicking on them. Selected teams will be highlighted.
                </p>
                <div class="teams-grid" id="teamsGrid"></div>
            </div>
        </section>

        <!-- Bracket Creation Section -->
        <section id="bracketSection" class="bracket-section">
            <h3>Create Tournament Bracket</h3>
            <p style="color: var(--medium-text); margin-bottom: 24px;">
                Select a bracket format for your tournament
            </p>
            <div class="bracket-options">
                <div class="bracket-option" data-bracket-type="single_elimination" tabindex="0">
                    <i class="fas fa-trophy" style="font-size: 2rem; color: var(--primary-blue); margin-bottom: 12px;"></i>
                    <h4>Single Elimination</h4>
                    <p>Teams compete until they lose. Best for quick tournaments.</p>
                    <p style="color: var(--success-green); font-weight: 600; margin-top: 8px;">
                        Matches: <span id="singleElimMatches">0</span>
                    </p>
                </div>
                <div class="bracket-option" data-bracket-type="round_robin" tabindex="0">
                    <i class="fas fa-list-ol" style="font-size: 2rem; color: var(--info-cyan); margin-bottom: 12px;"></i>
                    <h4>Round Robin</h4>
                    <p>All teams play each other. Best for fair competition.</p>
                    <p style="color: var(--warning-orange); font-weight: 600; margin-top: 8px;">
                        Matches: <span id="roundRobinMatches">0</span>
                    </p>
                </div>
            </div>
            
            <!-- Hidden field for AI recommendation ID -->
            <input type="hidden" id="recommendationId" name="recommendationId">
            
            <div style="text-align: center; margin-top: 32px;">
                <button id="createBracket" class="btn btn-success" style="min-width: 200px;">
                    <i class="fas fa-plus-circle"></i> Create Bracket
                </button>
                <button id="backToTeams" class="btn btn-secondary" style="min-width: 200px; margin-left: 16px;">
                    <i class="fas fa-arrow-left"></i> Back to Teams
                </button>
            </div>
        </section>

        <!-- Matches Display Section -->
        <section id="matchesSection" class="matches-section" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h3>Tournament Matches</h3>
                <div style="display: flex; gap: 12px;">
                    <span class="badge" style="background: var(--primary-blue); color: white; padding: 8px 16px; border-radius: 20px;">
                        <i class="fas fa-trophy"></i> <span id="bracketStatus">In Progress</span>
                    </span>
                </div>
            </div>
            <div id="matchesContainer" class="matches-container"></div>
            
            <!-- Debug Tools Section -->
            <div class="debug-tools">
                <h4><i class="fas fa-tools"></i> Tournament Tools</h4>
                <p style="color: var(--medium-text); margin-bottom: 16px;">
                    Advanced tools for tournament management
                </p>
                <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 10px;">
                    <button id="manualNextRound" class="btn btn-warning">
                        <i class="fas fa-forward"></i> Generate Next Round
                    </button>
                    <button id="checkRoundCompletion" class="btn btn-info">
                        <i class="fas fa-check-circle"></i> Check Round Completion
                    </button>
                    <button id="setChampion" class="btn btn-success">
                        <i class="fas fa-trophy"></i> Set Champion
                    </button>
                </div>
            </div>
            
            <!-- Navigation buttons -->
            <div style="margin-top: 32px; display: flex; gap: 16px; flex-wrap: wrap;">
                <button id="backToSports" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Sports
                </button>
                <button id="backToBrackets" class="btn btn-info" style="display: none;">
                    <i class="fas fa-list"></i> Back to Brackets List
                </button>
                <button id="createAnotherBracket" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Create Another Bracket
                </button>
            </div>
        </section>
    </main>

    <!-- Schedule Modals -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-calendar-plus"></i> Schedule Match</h3>
            <form id="scheduleForm">
                <input type="hidden" id="scheduleMatchId">
                <div class="form-group">
                    <label for="matchDate">Date & Time:</label>
                    <input type="datetime-local" id="matchDate" required class="form-control">
                </div>
                <div class="form-group">
                    <label for="venue">Venue:</label>
                    <input type="text" id="venue" required class="form-control" placeholder="Enter match venue">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Schedule</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('scheduleModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-flag-checkered"></i> Update Match Result</h3>
            <form id="resultForm">
                <input type="hidden" id="resultMatchId">
                <div class="form-group">
                    <label id="team1Name" style="font-weight: 600; color: var(--dark-text);"></label>
                    <input type="number" id="team1Score" min="0" required class="form-control" placeholder="Team 1 score">
                </div>
                <div class="form-group">
                    <label id="team2Name" style="font-weight: 600; color: var(--dark-text);"></label>
                    <input type="number" id="team2Score" min="0" required class="form-control" placeholder="Team 2 score">
                </div>
                <div class="form-group">
                    <label style="font-weight: 600; color: var(--dark-text);">Winner:</label>
                    <select id="winnerTeam" required class="form-control">
                        <option value="">Select Winner</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-success">Save Result</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('resultModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for logout confirmation -->
    <div id="logoutModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="hideLogoutModal()" style="position: absolute; right: 20px; top: 20px; background: none; border: none; font-size: 24px; cursor: pointer; color: var(--medium-text);">&times;</button>
            <h3>Are you sure you want to log out?</h3>
            <div class="modal-buttons" style="display: flex; gap: 16px; justify-content: flex-end; margin-top: 32px;">
                <button id="confirmLogout" class="btn btn-danger" style="min-width: 120px;">Confirm</button>
                <button id="cancelLogout" class="btn btn-secondary" style="min-width: 120px;">Cancel</button>
            </div>
        </div>
    </div>

    <script>
    let selectedEvent = null;
    let selectedSport = null;
    let selectedTeams = [];
    let selectedBracketType = null;
    let currentBracketId = null;
    let existingBrackets = [];
    let currentAIRecommendationId = null;

    // Enhanced initialization with keyboard support
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize all event listeners
        initializeEventListeners();
        
        // Add keyboard navigation for all interactive elements
        initializeKeyboardNavigation();
        
        // Calculate initial match counts
        updateMatchCounts();
        
        // Initialize AI team selection
        updateAITeamSelection();
        
        // Add touch support for mobile
        initializeTouchSupport();
    });

    // Initialize all event listeners
    function initializeEventListeners() {
        // Event card selection with visual feedback
        document.querySelectorAll('.event-card').forEach(card => {
            card.addEventListener('click', handleEventCardClick);
            card.addEventListener('keydown', handleEventCardKeydown);
        });
        
        // AI Recommendation Button
        document.getElementById('getAIRecommendation')?.addEventListener('click', getAIRecommendation);
        
        // Proceed without AI Button
        document.getElementById('proceedWithoutAI')?.addEventListener('click', function() {
            hideAIRecommendation();
            showTeamsSelection();
        });
        
        // Create new bracket button
        document.getElementById('createNewBracket')?.addEventListener('click', function() {
            showTeamsSelection();
        });
        
        // Create bracket button
        document.getElementById('createBracket')?.addEventListener('click', createBracket);
        
        // Back to Teams button
        document.getElementById('backToTeams')?.addEventListener('click', function() {
            showTeamsSelection();
        });
        
        // Navigation buttons
        document.getElementById('backToSports')?.addEventListener('click', showSportsSection);
        document.getElementById('backToBrackets')?.addEventListener('click', showBracketsList);
        document.getElementById('createAnotherBracket')?.addEventListener('click', createAnotherBracket);
        
        // Tournament tools
        document.getElementById('manualNextRound')?.addEventListener('click', generateNextRound);
        document.getElementById('checkRoundCompletion')?.addEventListener('click', checkRoundCompletion);
        document.getElementById('setChampion')?.addEventListener('click', setChampion);
        
        // Modal forms
        document.getElementById('scheduleForm').addEventListener('submit', handleScheduleSubmit);
        document.getElementById('resultForm').addEventListener('submit', handleResultSubmit);
        
        // Bracket options selection
        document.querySelectorAll('.bracket-option').forEach(option => {
            option.addEventListener('click', handleBracketOptionClick);
            option.addEventListener('keydown', handleBracketOptionKeydown);
        });
        
        // Logout modal
        document.getElementById('confirmLogout')?.addEventListener('click', function() {
            window.location.href = '/admin/logout';  
        });
        
        document.getElementById('cancelLogout')?.addEventListener('click', hideLogoutModal);
        
        // Team dropdown toggle
        const teamDropdownBtn = document.querySelector('.team-dropdown-btn');
        const teamDropdownContent = document.querySelector('.team-dropdown-content');
        if (teamDropdownBtn && teamDropdownContent) {
            teamDropdownBtn.addEventListener('click', function() {
                teamDropdownBtn.classList.toggle('active');
                teamDropdownContent.style.display = 
                    teamDropdownContent.style.display === "block" ? "none" : "block";
            });
        }
        
        // Admin profile dropdown
        const profileContainer = document.getElementById('adminProfileContainer');
        const dropdownMenu = document.getElementById('adminDropdownMenu');
        if (profileContainer && dropdownMenu) {
            profileContainer.addEventListener('click', function(e) {
                e.stopPropagation();
                dropdownMenu.style.display = 
                    dropdownMenu.style.display === 'block' ? 'none' : 'block';
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!profileContainer.contains(e.target)) {
                    dropdownMenu.style.display = 'none';
                }
            });
        }
        
        // Auto-hide success messages
        const successAlert = document.querySelector(".alert-success");
        if (successAlert) {
            setTimeout(() => {
                successAlert.style.transition = "opacity 0.5s ease";
                successAlert.style.opacity = "0";
                setTimeout(() => successAlert.remove(), 500);
            }, 3000);
        }
    }

    // Initialize keyboard navigation
    function initializeKeyboardNavigation() {
        // Add tabindex to all interactive elements
        document.querySelectorAll('.event-card, .sport-card, .team-card, .bracket-option, button, input, select')
            .forEach(el => {
                if (!el.hasAttribute('tabindex')) {
                    el.setAttribute('tabindex', '0');
                }
            });
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Escape key closes modals
            if (e.key === 'Escape') {
                closeModal('scheduleModal');
                closeModal('resultModal');
                hideLogoutModal();
            }
            
            // Ctrl+S for save (if in form)
            if (e.ctrlKey && e.key === 's' && document.activeElement.tagName === 'FORM') {
                e.preventDefault();
                document.activeElement.querySelector('button[type="submit"]')?.click();
            }
        });
    }

    // Initialize touch support for mobile
    function initializeTouchSupport() {
        // Add touch event listeners for mobile
        if ('ontouchstart' in window) {
            document.querySelectorAll('.event-card, .sport-card, .team-card, .bracket-option')
                .forEach(el => {
                    el.addEventListener('touchstart', function(e) {
                        this.classList.add('touch-active');
                    });
                    
                    el.addEventListener('touchend', function(e) {
                        this.classList.remove('touch-active');
                    });
                    
                    el.addEventListener('touchcancel', function(e) {
                        this.classList.remove('touch-active');
                    });
                });
        }
    }

    // Handle event card click
    function handleEventCardClick() {
        console.log('Event card clicked:', this.dataset.eventId);
        
        selectedEvent = {
            id: this.dataset.eventId,
            title: this.dataset.eventTitle
        };
        
        // Visual feedback
        this.style.transform = 'scale(0.98)';
        setTimeout(() => {
            this.style.transform = '';
        }, 150);
        
        document.getElementById('selectedEventTitle').textContent = this.dataset.eventTitle;
        loadSports(this.dataset.eventId);
    }

    // Handle event card keyboard navigation
    function handleEventCardKeydown(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            this.click();
        }
    }

    // Load sports for selected event
    async function loadSports(eventId) {
        try {
            showLoading('sportsGrid', 'Loading sports...');
            
            console.log('Loading sports for event ID:', eventId);
            const response = await fetch(`/admin/schedule/event/${eventId}/sports`);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log('Sports data received:', data);
            
            displaySports(data.sports);
            
            document.getElementById('sportsSection').style.display = 'block';
            document.getElementById('eventsSection').style.display = 'none';
            
            // Animate transition
            animateSectionTransition('sportsSection');
            
        } catch (error) {
            console.error('Error loading sports:', error);
            showError('sportsGrid', 'Error loading sports: ' + error.message);
        }
    }

    // Display sports in grid
    function displaySports(sports) {
        const sportsGrid = document.getElementById('sportsGrid');
        
        if (!sports || sports.length === 0) {
            sportsGrid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-baseball-ball" style="font-size: 3rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
                    <h4 style="color: var(--dark-text);">No Sports Available</h4>
                    <p style="color: var(--medium-text);">No sports have been added to this event yet.</p>
                </div>
            `;
            return;
        }
        
        // Group sports by category
        const groupedSports = groupSportsByCategory(sports);
        
        let html = '';
        
        // Display grouped sports
        Object.entries(groupedSports).forEach(([category, categorySports]) => {
            if (category === 'other') {
                // Display other sports directly
                categorySports.forEach(sport => {
                    html += createSportCardHTML(sport);
                });
            } else {
                // Display categorized sports
                html += `
                    <div class="sport-category-group">
                        <h5>${category.replace('_', ' ').toUpperCase()}</h5>
                        <div class="category-sports-grid">
                            ${categorySports.map(sport => createSportCardHTML(sport)).join('')}
                        </div>
                    </div>
                `;
            }
        });
        
        sportsGrid.innerHTML = html;
        
        // Add event listeners to sport cards
        document.querySelectorAll('.sport-card').forEach(card => {
            card.addEventListener('click', handleSportCardClick);
            card.addEventListener('keydown', handleSportCardKeydown);
        });
    }

    // Group sports by category
    function groupSportsByCategory(sports) {
        const groups = {};
        
        sports.forEach(sport => {
            // Determine category based on sport name and type
            let category = 'other';
            
            if (sport.name && sport.name.includes('badminton')) {
                category = 'badminton';
            } else if (sport.type) {
                category = sport.type.toLowerCase();
            }
            
            if (!groups[category]) {
                groups[category] = [];
            }
            
            groups[category].push(sport);
        });
        
        return groups;
    }

    // Create sport card HTML
    function createSportCardHTML(sport) {
        const displayName = sport.name || 'Unknown Sport';
        const sportType = sport.type ? sport.type.charAt(0).toUpperCase() + sport.type.slice(1).replace('_', ' ') : 'Sport';
        const category = sport.category || '';
        const gender = sport.gender || '';
        
        let categoryBadge = '';
        if (category) {
            const badgeClass = category.toLowerCase().includes('singles') ? 'category-singles' : 'category-doubles';
            categoryBadge = `<span class="category-badge ${badgeClass}">${category}</span>`;
        }
        
        return `
            <div class="sport-card ${sport.name.includes('badminton') ? 'badminton' : ''}" 
                 data-sport-type="${sport.type || ''}"
                 data-sport-name="${sport.name || ''}"
                 data-base-sport="${sport.baseSport || sport.name || ''}"
                 data-category="${category}"
                 data-gender="${gender}"
                 tabindex="0">
                <div class="sport-icon">
                    <i class="${getSportIcon(sport.name)}"></i>
                </div>
                <h5>${displayName}</h5>
                <small>${sportType}</small>
                ${categoryBadge}
                ${gender ? `<small style="display: block; margin-top: 4px;">${gender}</small>` : ''}
                <div class="select-indicator">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
        `;
    }

    // Get sport icon based on name
    function getSportIcon(sportName) {
        const icons = {
            'badminton': 'fas fa-table-tennis',
            'basketball': 'fas fa-basketball-ball',
            'football': 'fas fa-futbol',
            'volleyball': 'fas fa-volleyball-ball',
            'tennis': 'fas fa-baseball-ball',
            'chess': 'fas fa-chess',
            'swimming': 'fas fa-swimmer',
            'default': 'fas fa-running'
        };
        
        const lowerName = sportName.toLowerCase();
        for (const [key, icon] of Object.entries(icons)) {
            if (lowerName.includes(key)) {
                return icon;
            }
        }
        
        return icons.default;
    }

    // Handle sport card click
    function handleSportCardClick() {
        console.log('Sport card clicked:', this.dataset);
        
        // Remove selection from all cards
        document.querySelectorAll('.sport-card').forEach(c => {
            c.classList.remove('selected');
            c.setAttribute('aria-selected', 'false');
        });
        
        // Add selection to clicked card
        this.classList.add('selected');
        this.setAttribute('aria-selected', 'true');
        
        selectedSport = {
            type: this.dataset.sportType,
            name: this.dataset.sportName,
            baseSport: this.dataset.baseSport,
            category: this.dataset.category,
            gender: this.dataset.gender
        };
        
        console.log('Selected sport:', selectedSport);
        
        // Visual feedback
        this.style.transform = 'scale(0.98)';
        setTimeout(() => {
            this.style.transform = '';
        }, 150);
        
        // Proceed to next step
        checkExistingBrackets(selectedEvent.id, selectedSport.type, selectedSport.name);
    }

    // Handle sport card keyboard navigation
    function handleSportCardKeydown(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            this.click();
        }
    }

    // Check if brackets already exist for this sport
    async function checkExistingBrackets(eventId, sportType, sportName) {
        try {
            showLoading('teamsGrid', 'Checking existing brackets...');
            
            console.log(`Checking existing brackets for event ${eventId}, sport: ${sportName}`);
            const response = await fetch(`/admin/schedule/event/${eventId}/brackets`);
            const data = await response.json();
            
            console.log('All brackets data:', data.brackets);
            
            // Filter brackets by sport name
            existingBrackets = data.brackets.filter(bracket => {
                return bracket.sport_type && bracket.sport_type === sportName;
            });
            
            console.log('Filtered existing brackets:', existingBrackets);
            
            if (existingBrackets.length > 0) {
                showExistingBrackets(eventId, sportType, sportName);
            } else {
                loadTeams(eventId, sportType, sportName);
            }
        } catch (error) {
            console.error('Error checking existing brackets:', error);
            loadTeams(eventId, sportType, sportName);
        }
    }

    // Show existing brackets
    function showExistingBrackets(eventId, sportType, sportName) {
        const bracketList = document.getElementById('bracketList');
        
        if (existingBrackets.length === 0) {
            bracketList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-trophy" style="font-size: 3rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
                    <h4 style="color: var(--dark-text);">No Existing Brackets</h4>
                    <p style="color: var(--medium-text);">Create a new bracket to get started.</p>
                </div>
            `;
        } else {
            bracketList.innerHTML = existingBrackets.map(bracket => `
                <div class="bracket-item" data-bracket-id="${bracket.id}" tabindex="0">
                    <div class="bracket-header">
                        <h5>${bracket.bracket_type.replace('_', ' ').toUpperCase()} Bracket</h5>
                        <span class="status-badge ${bracket.is_completed ? 'completed' : 'in-progress'}">
                            ${bracket.is_completed ? 'Completed' : 'In Progress'}
                        </span>
                    </div>
                    <div class="bracket-details">
                        <p><i class="fas fa-flag"></i> Current Round: ${bracket.current_round || 1}</p>
                        ${bracket.champion_name ? `
                            <p><i class="fas fa-trophy"></i> Champion: ${bracket.champion_name}</p>
                        ` : ''}
                        <p><i class="fas fa-calendar"></i> Created: ${new Date(bracket.created_at).toLocaleDateString()}</p>
                    </div>
                    <div class="bracket-actions">
                        <button class="btn btn-sm btn-primary" onclick="loadExistingBracket('${bracket.id}')">
                            <i class="fas fa-eye"></i> View
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add keyboard support
            document.querySelectorAll('.bracket-item').forEach(item => {
                item.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const bracketId = this.dataset.bracketId;
                        loadExistingBracket(bracketId);
                    }
                });
            });
        }
        
        document.getElementById('existingBracketsSection').style.display = 'block';
        document.getElementById('teamsSelectionSection').style.display = 'none';
        document.getElementById('aiTeamSelectionSection').style.display = 'none';
        document.getElementById('selectedSportTitle').textContent = sportName;
        document.getElementById('teamsSection').style.display = 'block';
        document.getElementById('sportsSection').style.display = 'none';
        
        animateSectionTransition('teamsSection');
    }

    // Load existing bracket matches
    async function loadExistingBracket(bracketId) {
        currentBracketId = bracketId;
        await loadBracketMatches(bracketId);
        document.getElementById('backToBrackets').style.display = 'block';
    }

    // Load teams for selected event and sport
    async function loadTeams(eventId, sportType, sportName) {
        try {
            showLoading('teamsGrid', 'Loading teams...');
            
            console.log(`Loading teams for event ${eventId}, sport type: ${sportType}`);
            const response = await fetch(`/admin/schedule/event/${eventId}/sport/${sportType}/teams`);
            const data = await response.json();
            
            console.log('Teams data received:', data);
            
            displayTeams(data.teams, sportName);
            
            document.getElementById('existingBracketsSection').style.display = 'none';
            document.getElementById('teamsSelectionSection').style.display = 'block';
            document.getElementById('aiTeamSelectionSection').style.display = 'block';
            document.getElementById('selectedSportTitle').textContent = sportName;
            document.getElementById('teamsSection').style.display = 'block';
            document.getElementById('sportsSection').style.display = 'none';
            
            animateSectionTransition('teamsSection');
            
        } catch (error) {
            console.error('Error loading teams:', error);
            showError('teamsGrid', 'Error loading teams: ' + error.message);
        }
    }

    // Display teams in grid
    function displayTeams(teams, sportName) {
        const teamsGrid = document.getElementById('teamsGrid');
        
        if (!teams || teams.length === 0) {
            teamsGrid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-users" style="font-size: 3rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
                    <h4 style="color: var(--dark-text);">No Teams Registered</h4>
                    <p style="color: var(--medium-text);">No teams have registered for ${sportName} yet.</p>
                </div>
            `;
            return;
        }
        
        teamsGrid.innerHTML = teams.map(team => `
            <div class="team-card" 
                 data-team-id="${team.id}"
                 data-team-name="${team.teamName}"
                 tabindex="0"
                 aria-label="Select ${team.teamName} team">
                <div class="team-avatar">
                    <span>${team.teamName.charAt(0).toUpperCase()}</span>
                </div>
                <h5>${team.teamName}</h5>
                <p><i class="fas fa-user-tie"></i> ${team.coach_name || 'No Coach'}</p>
                <p><i class="fas fa-building"></i> ${team.organization || 'No Organization'}</p>
                <div class="select-indicator">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
        `).join('');
        
        // Add event listeners to team cards
        document.querySelectorAll('.team-card').forEach(card => {
            card.addEventListener('click', handleTeamCardClick);
            card.addEventListener('keydown', handleTeamCardKeydown);
        });
    }

    // Handle team card click
    function handleTeamCardClick() {
        const teamId = this.dataset.teamId;
        const teamName = this.dataset.teamName;
        
        // Toggle selection
        this.classList.toggle('selected');
        const isSelected = this.classList.contains('selected');
        
        if (isSelected) {
            selectedTeams.push({
                id: teamId,
                name: teamName
            });
            this.setAttribute('aria-selected', 'true');
        } else {
            selectedTeams = selectedTeams.filter(team => team.id !== teamId);
            this.setAttribute('aria-selected', 'false');
        }
        
        // Visual feedback
        this.style.transform = 'scale(0.98)';
        setTimeout(() => {
            this.style.transform = '';
        }, 150);
        
        updateAITeamSelection();
        updateMatchCounts();
    }

    // Handle team card keyboard navigation
    function handleTeamCardKeydown(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            this.click();
        }
    }

    // Update AI team selection display
    function updateAITeamSelection() {
        const teamCountElement = document.getElementById('aiTeamCount');
        const aiTeamSelectionSection = document.getElementById('aiTeamSelectionSection');
        
        if (teamCountElement) {
            teamCountElement.textContent = selectedTeams.length;
            teamCountElement.style.fontWeight = '700';
            teamCountElement.style.color = 'var(--primary-blue)';
        }
        
        if (aiTeamSelectionSection) {
            if (selectedTeams.length >= 2) {
                aiTeamSelectionSection.style.display = 'flex';
                
                // Update AI assistant message
                const message = selectedTeams.length >= 8 
                    ? `Selected ${selectedTeams.length} teams. AI recommends Single Elimination for large tournaments.`
                    : `Selected ${selectedTeams.length} teams. Ready for AI analysis.`;
                
                aiTeamSelectionSection.querySelector('p:nth-child(2)').textContent = message;
            } else {
                aiTeamSelectionSection.style.display = 'none';
            }
        }
    }

    // Calculate and update match counts
    function updateMatchCounts() {
        const teamCount = selectedTeams.length;
        
        // Calculate match counts for different bracket types
        const singleEliminationMatches = teamCount > 1 ? teamCount - 1 : 0;
        const roundRobinMatches = teamCount > 1 ? (teamCount * (teamCount - 1)) / 2 : 0;
        
        // Update UI
        const singleElimElement = document.getElementById('singleElimMatches');
        const roundRobinElement = document.getElementById('roundRobinMatches');
        
        if (singleElimElement) {
            singleElimElement.textContent = singleEliminationMatches;
            singleElimElement.style.color = singleEliminationMatches > 50 ? 'var(--danger-red)' : 'var(--success-green)';
        }
        
        if (roundRobinElement) {
            roundRobinElement.textContent = roundRobinMatches;
            roundRobinElement.style.color = roundRobinMatches > 50 ? 'var(--danger-red)' : 'var(--warning-orange)';
        }
        
        // Update bracket option descriptions
        document.querySelectorAll('.bracket-option').forEach(option => {
            const type = option.dataset.bracketType;
            let matchCount = 0;
            
            if (type === 'single_elimination') matchCount = singleEliminationMatches;
            if (type === 'round_robin') matchCount = roundRobinMatches;
            
            const matchText = matchCount > 0 ? `${matchCount} matches` : 'No matches';
            option.querySelector('p:nth-child(3)').textContent = matchText;
        });
    }

    // Get AI Recommendation
    async function getAIRecommendation() {
        if (selectedTeams.length < 2) {
            showNotification('Please select at least 2 teams for AI recommendation', 'warning');
            return;
        }

        try {
            // Show loading with animation
            document.getElementById('aiLoading').style.display = 'block';
            document.getElementById('aiRecommendationContent').style.display = 'none';
            document.getElementById('aiRecommendationSection').style.display = 'block';
            
            animateSectionTransition('aiRecommendationSection');
            
            const teamIds = selectedTeams.map(team => team.id);
            
            console.log('Getting AI recommendation for:', {
                eventId: selectedEvent.id,
                sportType: selectedSport.type,
                teamCount: teamIds.length
            });
            
            const response = await fetch(`/admin/format-recommendations/${selectedEvent.id}/${encodeURIComponent(selectedSport.type)}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    teamIds: teamIds,
                    selectedTeams: selectedTeams.map(t => t.name)
                })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log('AI Recommendation data:', data);
            
            if (data.success) {
                currentAIRecommendationId = data.recommendationId;
                document.getElementById('recommendationId').value = currentAIRecommendationId;
                displayAIRecommendation(data);
            } else {
                throw new Error(data.error || 'Failed to get AI recommendation');
            }
        } catch (error) {
            console.error('Error getting AI recommendation:', error);
            document.getElementById('aiLoading').innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-triangle"></i> 
                    <strong>Error getting AI recommendation</strong>
                    <p style="margin: 5px 0 0 0;">${error.message}</p>
                </div>
                <button onclick="hideAIRecommendation()" class="btn btn-secondary" style="margin-top: 15px;">
                    <i class="fas fa-arrow-left"></i> Back to Team Selection
                </button>
            `;
        }
    }

    // Display AI Recommendation
    function displayAIRecommendation(data) {
        const content = document.getElementById('aiRecommendationContent');
        
        // Hide loading, show content with animation
        document.getElementById('aiLoading').style.display = 'none';
        content.style.display = 'block';
        content.style.animation = 'fadeIn 0.5s ease';
        
        // Create recommendation cards
        const recommendations = [data.recommendation, ...(data.alternatives || [])];
        
        let html = `
            <div class="ai-analysis-summary">
                <h5><i class="fas fa-chart-bar"></i> Tournament Analysis Summary</h5>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="summary-label">Teams Selected</span>
                        <span class="summary-value">${data.analysis.teamCount}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Optimal Format</span>
                        <span class="summary-value highlight">${data.recommendation.format.replace('_', ' ').toUpperCase()}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">AI Confidence</span>
                        <span class="confidence-badge">${data.recommendation.confidence}%</span>
                    </div>
                </div>
                <div class="reason-box">
                    <strong><i class="fas fa-lightbulb"></i> Recommendation Reason:</strong>
                    <p>${data.recommendation.reason || 'Based on optimal tournament logistics and historical data analysis'}</p>
                </div>
            </div>
            
            <div class="recommendation-stats">
                <h5><i class="fas fa-calculator"></i> Match Count Analysis</h5>
                <div class="stats-grid">
        `;
        
        // Add match count stats
        Object.entries(data.analysis.matchCounts || {}).forEach(([format, count]) => {
            const formatName = format.replace('_', ' ').toUpperCase();
            html += `
                <div class="stat-item">
                    <div class="stat-value">${count}</div>
                    <div class="stat-label">${formatName}</div>
                </div>
            `;
        });
        
        html += `
                </div>
            </div>
            
            <h4 style="color: var(--dark-text); margin: 25px 0 20px 0;">
                <i class="fas fa-list-ol"></i> Format Recommendations
            </h4>
            
            <div class="recommendations-container">
        `;
        
        // Add all recommendation cards
        recommendations.forEach((rec, index) => {
            html += createRecommendationCard(rec, index === 0);
        });
        
        html += `
            </div>
            
            <div class="match-comparison">
                <h5><i class="fas fa-exchange-alt"></i> Format Comparison</h5>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Format</th>
                                <th>Total Matches</th>
                                <th>Days Needed*</th>
                                <th>Complexity</th>
                                <th>Fairness</th>
                            </tr>
                        </thead>
                        <tbody>
        `;
        
        // Add comparison rows
        recommendations.forEach((rec, index) => {
            const daysNeeded = Math.ceil(rec.matches / (data.analysis.dailyCapacity?.maxMatchesPerDay || 8));
            const complexity = data.analysis.complexity?.[rec.format] || 'Medium';
            const isRecommended = index === 0;
            
            html += `
                <tr ${isRecommended ? 'class="recommended-row"' : ''}>
                    <td><strong>${rec.format.replace('_', ' ').toUpperCase()}</strong></td>
                    <td>${rec.matches}</td>
                    <td>${daysNeeded}</td>
                    <td><span class="complexity-${complexity.toLowerCase().replace(' ', '-')}">${complexity}</span></td>
                    <td>${rec.fairness || 'High'}</td>
                </tr>
            `;
        });
        
        html += `
                        </tbody>
                    </table>
                </div>
                <small class="text-muted">*Based on ${data.analysis.dailyCapacity?.maxMatchesPerDay || 8} matches per day</small>
            </div>
            
            <div class="recommendation-actions">
                <button class="btn btn-success" onclick="useAIRecommendation('${data.recommendation.format}')">
                    <i class="fas fa-check"></i> Use ${data.recommendation.format.replace('_', ' ').toUpperCase()} Format
                </button>
                <button class="btn btn-outline-primary" onclick="compareFormats()">
                    <i class="fas fa-balance-scale"></i> Compare All Formats
                </button>
                <button class="btn btn-secondary" onclick="hideAIRecommendation()">
                    <i class="fas fa-arrow-left"></i> Back to Team Selection
                </button>
            </div>
        `;
        
        content.innerHTML = html;
        
        // Add animations to recommendation cards
        setTimeout(() => {
            document.querySelectorAll('.recommendation-card').forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('animate-in');
            });
        }, 100);
    }

    // Create recommendation card
    function createRecommendationCard(recommendation, isMain) {
        const isRecommended = recommendation.recommendation?.includes('RECOMMENDED') || isMain;
        const isNotRecommended = recommendation.recommendation?.includes('NOT RECOMMENDED');
        
        const cardClass = isRecommended ? 'recommended' : isNotRecommended ? 'not-recommended' : 'alternative';
        const badgeClass = isRecommended ? 'recommended' : isNotRecommended ? 'not-recommended' : 'alternative';
        
        return `
            <div class="recommendation-card ${cardClass}">
                <div class="recommendation-header">
                    <div class="format-info">
                        <h4>${recommendation.format.replace('_', ' ').toUpperCase()}</h4>
                        <div class="match-count">
                            <i class="fas fa-hashtag"></i> ${recommendation.matches} matches
                        </div>
                    </div>
                    <span class="recommendation-badge ${badgeClass}">
                        ${isRecommended ? 'RECOMMENDED' : isNotRecommended ? 'NOT RECOMMENDED' : 'ALTERNATIVE'}
                    </span>
                </div>
                <div class="recommendation-details">
                    <p class="description">${recommendation.description || 'Tournament format option'}</p>
                    <div class="details-grid">
                        <div class="detail-item">
                            <i class="fas fa-flag"></i>
                            <span>${recommendation.rounds || 1} rounds</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-clock"></i>
                            <span>${Math.ceil(recommendation.matches / 8)} days est.</span>
                        </div>
                        ${recommendation.confidence ? `
                        <div class="detail-item">
                            <i class="fas fa-brain"></i>
                            <span>${recommendation.confidence}% confidence</span>
                        </div>
                        ` : ''}
                    </div>
                    ${recommendation.warning ? `
                    <div class="warning-alert">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>${recommendation.warning}</span>
                    </div>
                    ` : ''}
                </div>
                ${isMain ? `
                <div class="recommendation-actions">
                    <button class="btn btn-success" onclick="useAIRecommendation('${recommendation.format}')">
                        <i class="fas fa-check"></i> Use This Format
                    </button>
                    ${recommendation.matches > 50 ? `
                    <button class="btn btn-warning" onclick="showWarning(${recommendation.matches})">
                        <i class="fas fa-exclamation-triangle"></i> Large Tournament
                    </button>
                    ` : ''}
                </div>
                ` : ''}
            </div>
        `;
    }

    // Use AI recommendation
    function useAIRecommendation(format) {
        // Set the bracket type
        selectedBracketType = format;
        
        // Update UI to show selection
        document.querySelectorAll('.bracket-option').forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-selected', 'false');
            if (o.dataset.bracketType === format) {
                o.classList.add('selected');
                o.setAttribute('aria-selected', 'true');
            }
        });
        
        // Hide AI section, show bracket section with animation
        document.getElementById('aiRecommendationSection').style.display = 'none';
        document.getElementById('bracketSection').style.display = 'block';
        document.getElementById('teamsSection').style.display = 'none';
        
        animateSectionTransition('bracketSection');
        
        // Show success notification
        const matchCounts = {
            single_elimination: selectedTeams.length - 1,
            round_robin: (selectedTeams.length * (selectedTeams.length - 1)) / 2,
            double_elimination: 2 * selectedTeams.length - 1
        };
        
        const matchCount = matchCounts[format] || 0;
        
        if (matchCount > 100) {
            showWarning(matchCount, format);
        } else {
            showNotification(
                `âœ… AI Recommendation Applied: ${format.replace('_', ' ').toUpperCase()} format selected.`,
                'success'
            );
        }
    }

    // Hide AI recommendation
    function hideAIRecommendation() {
        document.getElementById('aiRecommendationSection').style.display = 'none';
        showTeamsSelection();
    }

    // Show warning for many matches
    function showWarning(matchCount, format) {
        const message = `âš ï¸ Warning: ${format.replace('_', ' ').toUpperCase()} format will create ${matchCount} matches.
For ${selectedTeams.length} teams, this might result in a very long tournament.
Consider using Single Elimination (${selectedTeams.length - 1} matches) instead.`;
        
        if (confirm(message.replace(/\n/g, ' '))) {
            showNotification(
                `âœ… ${format.replace('_', ' ').toUpperCase()} format confirmed. Creating ${matchCount} matches.`,
                'success'
            );
        } else {
            selectedBracketType = null;
            document.querySelectorAll('.bracket-option').forEach(o => {
                o.classList.remove('selected');
                o.setAttribute('aria-selected', 'false');
            });
        }
    }

    // Handle bracket option click
    function handleBracketOptionClick() {
        const bracketType = this.dataset.bracketType;
        
        // Remove selection from all options
        document.querySelectorAll('.bracket-option').forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-selected', 'false');
        });
        
        // Add selection to clicked option
        this.classList.add('selected');
        this.setAttribute('aria-selected', 'true');
        
        selectedBracketType = bracketType;
        
        // Visual feedback
        this.style.transform = 'scale(0.98)';
        setTimeout(() => {
            this.style.transform = '';
        }, 150);
    }

    // Handle bracket option keyboard navigation
    function handleBracketOptionKeydown(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            this.click();
        }
    }

    // Create bracket
    async function createBracket() {
        if (!selectedBracketType) {
            showNotification('Please select a bracket type', 'warning');
            return;
        }

        if (selectedTeams.length < 2) {
            showNotification('Please select at least 2 teams', 'warning');
            return;
        }

        try {
            showLoading('matchesContainer', 'Creating bracket...');
            
            const teamIds = selectedTeams.map(team => team.id);
            
            console.log('Creating bracket with data:', {
                eventId: selectedEvent.id,
                sportType: selectedSport.type,
                sportName: selectedSport.name,
                bracketType: selectedBracketType,
                teams: teamIds,
                recommendationId: currentAIRecommendationId
            });
            
            const response = await fetch('/admin/schedule/create-bracket', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    eventId: selectedEvent.id,
                    sportType: selectedSport.type,
                    sportName: selectedSport.name,
                    bracketType: selectedBracketType,
                    teams: teamIds,
                    recommendationId: currentAIRecommendationId
                })
            });

            const data = await response.json();
            
            if (data.success) {
                currentBracketId = data.bracketId;
                showNotification('Bracket created successfully!', 'success');
                await loadBracketMatches(data.bracketId);
            } else {
                throw new Error(data.error || 'Error creating bracket');
            }
        } catch (error) {
            console.error('Error creating bracket:', error);
            showNotification('Error creating bracket: ' + error.message, 'error');
        }
    }

    // Load bracket matches
    async function loadBracketMatches(bracketId) {
        try {
            showLoading('matchesContainer', 'Loading matches...');
            
            console.log(`Loading matches for bracket ${bracketId}`);
            const response = await fetch(`/admin/schedule/bracket/${bracketId}/matches`);
            const data = await response.json();
            
            console.log('Matches data:', data.matches);
            console.log('Bracket data:', data.bracket);
            
            displayMatches(data.matches, data.bracket);
            
            document.getElementById('matchesSection').style.display = 'block';
            document.getElementById('bracketSection').style.display = 'none';
            document.getElementById('teamsSection').style.display = 'none';
            
            animateSectionTransition('matchesSection');
            
        } catch (error) {
            console.error('Error loading matches:', error);
            showError('matchesContainer', 'Error loading matches: ' + error.message);
        }
    }

    // Display matches
    function displayMatches(matches, bracket) {
        const container = document.getElementById('matchesContainer');
        
        // Update bracket status
        document.getElementById('bracketStatus').textContent = 
            bracket.is_completed ? 'Completed' : 'In Progress';
        
        // Create bracket header
        let html = `
            <div class="bracket-header-card">
                <div class="bracket-title">
                    <h4>${bracket.event_name} - ${bracket.sport_type}</h4>
                    <span class="bracket-type">${bracket.bracket_type.replace('_', ' ').toUpperCase()}</span>
                </div>
                <div class="bracket-meta">
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>Created: ${new Date(bracket.created_at).toLocaleDateString()}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-flag"></i>
                        <span>Current Round: ${bracket.current_round || 1}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-clock"></i>
                        <span>Status: ${bracket.is_completed ? 'Completed' : 'In Progress'}</span>
                    </div>
                    ${bracket.champion_name ? `
                    <div class="meta-item champion">
                        <i class="fas fa-trophy"></i>
                        <span>Champion: ${bracket.champion_name}</span>
                    </div>
                    ` : ''}
                </div>
            </div>
        `;
        
        // Group matches by round
        const rounds = {};
        matches.forEach(match => {
            if (!rounds[match.round_number]) {
                rounds[match.round_number] = [];
            }
            rounds[match.round_number].push(match);
        });
        
        // Sort rounds numerically
        const sortedRounds = Object.keys(rounds).sort((a, b) => a - b);
        
        // Display each round
        sortedRounds.forEach(roundNumber => {
            const roundMatches = rounds[roundNumber];
            const completedMatches = roundMatches.filter(m => m.status === 'completed').length;
            const totalMatches = roundMatches.length;
            const completionPercentage = totalMatches > 0 ? Math.round((completedMatches / totalMatches) * 100) : 0;
            
            html += `
                <div class="round">
                    <div class="round-header">
                        <div class="round-title">
                            <i class="fas fa-flag"></i>
                            <h4>Round ${roundNumber}</h4>
                        </div>
                        <div class="round-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${completionPercentage}%"></div>
                            </div>
                            <span class="progress-text">${completedMatches}/${totalMatches} matches (${completionPercentage}%)</span>
                        </div>
                    </div>
                    <div class="matches-grid">
            `;
            
            roundMatches.forEach(match => {
                html += createMatchCardHTML(match);
            });
            
            html += `
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        
        // Add event listeners to match action buttons
        document.querySelectorAll('.match-schedule-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const matchId = this.dataset.matchId;
                const team1Name = this.dataset.team1Name;
                const team2Name = this.dataset.team2Name;
                openScheduleModal(matchId, team1Name, team2Name);
            });
        });
        
        document.querySelectorAll('.match-result-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const matchId = this.dataset.matchId;
                const team1Id = this.dataset.team1Id;
                const team1Name = this.dataset.team1Name;
                const team2Id = this.dataset.team2Id;
                const team2Name = this.dataset.team2Name;
                openResultModal(matchId, team1Id, team1Name, team2Id, team2Name);
            });
        });
    }

    // Create match card HTML
    function createMatchCardHTML(match) {
        const isCompleted = match.status === 'completed';
        const hasSchedule = match.match_date && match.venue;
        
        // Format date if available
        let dateInfo = '';
        if (match.match_date) {
            const matchDate = new Date(match.match_date);
            dateInfo = `
                <div class="match-schedule">
                    <div class="schedule-item">
                        <i class="fas fa-calendar"></i>
                        <span>${matchDate.toLocaleDateString()}</span>
                    </div>
                    <div class="schedule-item">
                        <i class="fas fa-clock"></i>
                        <span>${matchDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                    </div>
                    ${match.venue ? `
                    <div class="schedule-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>${match.venue}</span>
                    </div>
                    ` : ''}
                </div>
            `;
        }
        
        // Winner info if available
        let winnerInfo = '';
        if (match.winner_name) {
            const team1Won = match.winner_name === match.team1_name;
            const team2Won = match.winner_name === match.team2_name;
            
            winnerInfo = `
                <div class="match-result">
                    <div class="result-score">
                        <span class="score ${team1Won ? 'winner' : ''}">${match.team1_score || 0}</span>
                        <span class="score-separator">:</span>
                        <span class="score ${team2Won ? 'winner' : ''}">${match.team2_score || 0}</span>
                    </div>
                    <div class="winner-info">
                        <i class="fas fa-trophy"></i>
                        <span>${match.winner_name}</span>
                    </div>
                </div>
            `;
        }
        
        return `
            <div class="match-card ${isCompleted ? 'completed' : ''} ${hasSchedule ? 'scheduled' : ''}">
                <div class="teams-display">
                    <div class="team ${match.winner_name === match.team1_name ? 'winner' : ''}">
                        <span class="team-name">${match.team1_name || 'TBD'}</span>
                        ${match.team1_score !== null ? `<span class="team-score">${match.team1_score}</span>` : ''}
                    </div>
                    <div class="vs">
                        <span>VS</span>
                    </div>
                    <div class="team ${match.winner_name === match.team2_name ? 'winner' : ''}">
                        <span class="team-name">${match.team2_name || 'TBD'}</span>
                        ${match.team2_score !== null ? `<span class="team-score">${match.team2_score}</span>` : ''}
                    </div>
                </div>
                
                ${dateInfo}
                ${winnerInfo}
                
                <div class="match-actions">
                    ${!hasSchedule ? `
                    <button class="btn btn-primary match-schedule-btn" 
                            data-match-id="${match.id}"
                            data-team1-name="${match.team1_name || 'TBD'}"
                            data-team2-name="${match.team2_name || 'TBD'}">
                        <i class="fas fa-calendar-plus"></i> Schedule
                    </button>
                    ` : ''}
                    
                    ${!isCompleted ? `
                    <button class="btn btn-success match-result-btn"
                            data-match-id="${match.id}"
                            data-team1-id="${match.team1_id}"
                            data-team1-name="${match.team1_name || 'TBD'}"
                            data-team2-id="${match.team2_id}"
                            data-team2-name="${match.team2_name || 'TBD'}">
                        <i class="fas fa-flag-checkered"></i> Set Result
                    </button>
                    ` : `
                    <button class="btn btn-outline-secondary" disabled>
                        <i class="fas fa-check"></i> Completed
                    </button>
                    `}
                </div>
            </div>
        `;
    }

    // Generate next round
    async function generateNextRound() {
        if (!currentBracketId) {
            showNotification('No bracket selected', 'warning');
            return;
        }

        try {
            // Get current bracket info
            const response = await fetch(`/admin/schedule/bracket/${currentBracketId}/matches`);
            const data = await response.json();
            
            const currentRound = data.bracket.current_round;
            const matches = data.matches;
            const maxRound = Math.max(...matches.map(m => m.round_number));
            const roundToUse = currentRound || maxRound;
            
            showLoading('matchesContainer', 'Generating next round...');
            
            const nextRoundResponse = await fetch('/admin/schedule/generate-next-round', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    bracketId: currentBracketId,
                    currentRound: roundToUse
                })
            });

            const result = await nextRoundResponse.json();
            
            if (result.success) {
                showNotification('Next round generated successfully!', 'success');
                await loadBracketMatches(currentBracketId);
            } else {
                throw new Error(result.error || 'Error generating next round');
            }
        } catch (error) {
            console.error('Error generating next round:', error);
            showNotification('Error generating next round: ' + error.message, 'error');
        }
    }

    // Check round completion
    async function checkRoundCompletion() {
        if (!currentBracketId) {
            showNotification('No bracket selected', 'warning');
            return;
        }

        try {
            const response = await fetch(`/admin/schedule/bracket/${currentBracketId}/matches`);
            const data = await response.json();
            
            const matches = data.matches;
            const bracket = data.bracket;
            
            // Group matches by round
            const rounds = {};
            matches.forEach(match => {
                if (!rounds[match.round_number]) {
                    rounds[match.round_number] = [];
                }
                rounds[match.round_number].push(match);
            });
            
            let message = `Tournament Status: ${bracket.event_name} - ${bracket.sport_type}\n\n`;
            let allRoundsComplete = true;
            
            Object.keys(rounds).sort((a, b) => a - b).forEach(roundNumber => {
                const roundMatches = rounds[roundNumber];
                const completed = roundMatches.filter(m => m.status === 'completed').length;
                const total = roundMatches.length;
                
                message += `Round ${roundNumber}: ${completed}/${total} matches completed\n`;
                
                if (completed === total && completed > 0) {
                    message += `âœ… Round ${roundNumber} is COMPLETED\n`;
                } else if (completed > 0) {
                    message += `â³ Round ${roundNumber} is IN PROGRESS (${total - completed} matches remaining)\n`;
                    allRoundsComplete = false;
                } else {
                    message += `âŒ Round ${roundNumber} has NO RESULTS yet\n`;
                    allRoundsComplete = false;
                }
                message += '\n';
            });
            
            if (allRoundsComplete && !bracket.is_completed) {
                message += 'ðŸŽ‰ All rounds are complete! The tournament is ready for champion declaration.\n';
            }
            
            alert(message);
        } catch (error) {
            console.error('Error checking round completion:', error);
            showNotification('Error checking round completion', 'error');
        }
    }

    // Set champion manually
    async function setChampion() {
        if (!currentBracketId) {
            showNotification('No bracket selected', 'warning');
            return;
        }

        if (!confirm('Are you sure you want to manually set the champion? This should only be used if the automatic champion detection failed.')) {
            return;
        }

        try {
            const response = await fetch('/admin/schedule/set-champion', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    bracketId: currentBracketId
                })
            });

            const result = await response.json();
            
            if (result.success) {
                showNotification(result.message || 'Champion set successfully!', 'success');
                await loadBracketMatches(currentBracketId);
            } else {
                throw new Error(result.error || 'Error setting champion');
            }
        } catch (error) {
            console.error('Error setting champion:', error);
            showNotification('Error setting champion: ' + error.message, 'error');
        }
    }

    // Navigation functions
    function showSportsSection() {
        document.getElementById('matchesSection').style.display = 'none';
        document.getElementById('sportsSection').style.display = 'block';
        resetSelection();
        animateSectionTransition('sportsSection');
    }

    function showTeamsSelection() {
        document.getElementById('aiRecommendationSection').style.display = 'none';
        document.getElementById('aiTeamSelectionSection').style.display = 'flex';
        document.getElementById('teamsSelectionSection').style.display = 'block';
        document.getElementById('teamsSection').style.display = 'block';
        animateSectionTransition('teamsSection');
    }

    function showBracketsList() {
        document.getElementById('matchesSection').style.display = 'none';
        document.getElementById('teamsSection').style.display = 'block';
        document.getElementById('backToBrackets').style.display = 'none';
        animateSectionTransition('teamsSection');
    }

    function createAnotherBracket() {
        document.getElementById('matchesSection').style.display = 'none';
        document.getElementById('teamsSection').style.display = 'block';
        document.getElementById('existingBracketsSection').style.display = 'none';
        document.getElementById('teamsSelectionSection').style.display = 'block';
        resetTeamSelection();
        animateSectionTransition('teamsSection');
    }

    // Reset selection
    function resetSelection() {
        selectedEvent = null;
        selectedSport = null;
        selectedTeams = [];
        selectedBracketType = null;
        currentBracketId = null;
        currentAIRecommendationId = null;
        existingBrackets = [];
        
        // Reset UI states
        document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
        document.getElementById('recommendationId').value = '';
        updateAITeamSelection();
        updateMatchCounts();
    }

    function resetTeamSelection() {
        selectedTeams = [];
        selectedBracketType = null;
        currentBracketId = null;
        currentAIRecommendationId = null;
        
        // Reset UI states
        document.querySelectorAll('.team-card.selected').forEach(card => {
            card.classList.remove('selected');
            card.setAttribute('aria-selected', 'false');
        });
        
        document.getElementById('recommendationId').value = '';
        updateAITeamSelection();
        updateMatchCounts();
    }

    // Modal functions
    function openScheduleModal(matchId, team1Name, team2Name) {
        document.getElementById('scheduleMatchId').value = matchId;
        
        // Set default date to tomorrow
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(10, 0, 0, 0);
        
        const dateInput = document.getElementById('matchDate');
        dateInput.value = tomorrow.toISOString().slice(0, 16);
        
        // Set placeholder for venue
        document.getElementById('venue').placeholder = 'e.g., Main Gym Court 1';
        
        document.getElementById('scheduleModal').style.display = 'block';
        document.getElementById('scheduleModal').setAttribute('aria-hidden', 'false');
        
        // Focus on first input
        setTimeout(() => {
            dateInput.focus();
        }, 100);
    }

    function openResultModal(matchId, team1Id, team1Name, team2Id, team2Name) {
        document.getElementById('resultMatchId').value = matchId;
        document.getElementById('team1Name').textContent = team1Name + ' Score:';
        document.getElementById('team2Name').textContent = team2Name + ' Score:';
        
        const winnerSelect = document.getElementById('winnerTeam');
        winnerSelect.innerHTML = `
            <option value="">Select Winner</option>
            <option value="${team1Id}">${team1Name}</option>
            <option value="${team2Id}">${team2Name}</option>
        `;
        
        // Reset scores
        document.getElementById('team1Score').value = '';
        document.getElementById('team2Score').value = '';
        
        document.getElementById('resultModal').style.display = 'block';
        document.getElementById('resultModal').setAttribute('aria-hidden', 'false');
        
        // Focus on first input
        setTimeout(() => {
            document.getElementById('team1Score').focus();
        }, 100);
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
        
        // Reset form
        const form = modal.querySelector('form');
        if (form) {
            form.reset();
        }
    }

    // Handle schedule form submission
    async function handleScheduleSubmit(e) {
        e.preventDefault();
        
        const matchId = document.getElementById('scheduleMatchId').value;
        const matchDate = document.getElementById('matchDate').value;
        const venue = document.getElementById('venue').value;
        
        if (!matchDate || !venue) {
            showNotification('Please fill in all fields', 'warning');
            return;
        }
        
        try {
            const response = await fetch(`/admin/schedule/match/${matchId}/schedule`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    matchDate: matchDate,
                    venue: venue.trim()
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                showNotification('Schedule updated successfully!', 'success');
                closeModal('scheduleModal');
                await loadBracketMatches(currentBracketId);
            } else {
                throw new Error(data.error || 'Error updating schedule');
            }
        } catch (error) {
            console.error('Error updating schedule:', error);
            showNotification('Error updating schedule: ' + error.message, 'error');
        }
    }

    // Handle result form submission
    async function handleResultSubmit(e) {
        e.preventDefault();
        
        const matchId = document.getElementById('resultMatchId').value;
        const team1Score = parseInt(document.getElementById('team1Score').value);
        const team2Score = parseInt(document.getElementById('team2Score').value);
        const winnerTeam = document.getElementById('winnerTeam').value;
        
        if (isNaN(team1Score) || isNaN(team2Score) || !winnerTeam) {
            showNotification('Please fill in all fields correctly', 'warning');
            return;
        }
        
        if (team1Score < 0 || team2Score < 0) {
            showNotification('Scores cannot be negative', 'warning');
            return;
        }
        
        if (team1Score === team2Score) {
            showNotification('Scores cannot be equal. Please determine a winner.', 'warning');
            return;
        }
        
        try {
            const response = await fetch(`/admin/schedule/match/${matchId}/result`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    team1Score: team1Score,
                    team2Score: team2Score,
                    winnerTeamId: winnerTeam
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                showNotification('Result updated successfully!', 'success');
                closeModal('resultModal');
                await loadBracketMatches(currentBracketId);
            } else {
                throw new Error(data.error || 'Error updating result');
            }
        } catch (error) {
            console.error('Error updating result:', error);
            showNotification('Error updating result: ' + error.message, 'error');
        }
    }

    // Compare formats function
    function compareFormats() {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 800px;">
                <h3><i class="fas fa-balance-scale"></i> Format Comparison</h3>
                <div class="comparison-content">
                    <p>Detailed comparison of tournament formats based on ${selectedTeams.length} teams:</p>
                    <!-- Comparison content would be populated here -->
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">Close</button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        modal.style.display = 'block';
    }

    // Show loading state
    function showLoading(containerId, message = 'Loading...') {
        const container = document.getElementById(containerId);
        if (container) {
            container.innerHTML = `
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>${message}</p>
                </div>
            `;
        }
    }

    // Show error state
    function showError(containerId, message) {
        const container = document.getElementById(containerId);
        if (container) {
            container.innerHTML = `
                <div class="error-state">
                    <i class="fas fa-exclamation-circle"></i>
                    <p>${message}</p>
                    <button class="btn btn-secondary" onclick="location.reload()">
                        <i class="fas fa-redo"></i> Reload
                    </button>
                </div>
            `;
        }
    }

    // Show notification
    function showNotification(message, type = 'info') {
        // Remove existing notifications
        const existingNotifications = document.querySelectorAll('.notification');
        existingNotifications.forEach(n => n.remove());
        
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
                <button class="notification-close" onclick="this.parentElement.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Auto-remove after 5 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 5000);
    }

    // Animate section transition
    function animateSectionTransition(sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
            section.style.animation = 'fadeInUp 0.4s ease';
            setTimeout(() => {
                section.style.animation = '';
            }, 400);
        }
    }

    // Show the logout confirmation modal
    function showLogoutModal() {
        document.getElementById('logoutModal').style.display = 'block';
        document.getElementById('logoutModal').setAttribute('aria-hidden', 'false');
    }
    
    function hideLogoutModal() {
        document.getElementById('logoutModal').style.display = 'none';
        document.getElementById('logoutModal').setAttribute('aria-hidden', 'true');
    }

    // Sidebar toggle
    let isSidebarOpen = false;

    function toggleNav() {
        const sidebar = document.getElementById("mySidebar");
        const content = document.querySelector(".schedule-container");
        const sidebarBtn = document.querySelector(".sidebar-btn");

        if (isSidebarOpen) {
            sidebar.style.left = "-240px";  
            content.style.marginLeft = "0"; 
            sidebarBtn.innerHTML = "&#9776;"; 
            sidebarBtn.setAttribute('aria-label', 'Open sidebar');
        } else {
            sidebar.style.left = "0";  
            content.style.marginLeft = "240px";  
            sidebarBtn.innerHTML = "&#9776;"; 
            sidebarBtn.setAttribute('aria-label', 'Close sidebar');
        }
        isSidebarOpen = !isSidebarOpen;
        
        // Update ARIA attributes
        sidebar.setAttribute('aria-hidden', !isSidebarOpen);
    }

    // Add CSS for animations and additional styles
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .loading-state, .error-state, .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--medium-text);
        }
        
        .loading-state .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-light);
            border-top-color: var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        .error-state i {
            font-size: 3rem;
            color: var(--danger-red);
            margin-bottom: 1rem;
        }
        
        .empty-state i {
            font-size: 3rem;
            color: var(--primary-blue);
            margin-bottom: 1rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            max-width: 400px;
            animation: fadeInUp 0.3s ease;
        }
        
        .notification-content {
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 4px solid;
        }
        
        .notification-success .notification-content {
            border-left-color: var(--success-green);
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }
        
        .notification-error .notification-content {
            border-left-color: var(--danger-red);
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
        }
        
        .notification-warning .notification-content {
            border-left-color: var(--warning-orange);
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
        }
        
        .notification-info .notification-content {
            border-left-color: var(--info-cyan);
            background: linear-gradient(135deg, #ecfeff, #cffafe);
        }
        
        .notification-close {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            margin-left: auto;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .notification-close:hover {
            opacity: 1;
        }
        
        .sport-icon {
            font-size: 2rem;
            color: var(--primary-blue);
            margin-bottom: 1rem;
        }
        
        .team-avatar {
            width: 50px;
            height: 50px;
            background: var(--primary-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 1rem;
        }
        
        .select-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            color: var(--success-green);
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .selected .select-indicator {
            opacity: 1;
        }
        
        .touch-active {
            opacity: 0.8;
        }
        
        .recommendation-card.animate-in {
            animation: fadeInUp 0.5s ease backwards;
        }
        
        .bracket-header-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
        }
        
        .bracket-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .bracket-type {
            background: var(--primary-blue);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .bracket-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--medium-text);
        }
        
        .meta-item.champion {
            color: var(--success-green);
            font-weight: 600;
        }
        
        .round-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background: var(--border-light);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--success-green);
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: var(--medium-text);
            white-space: nowrap;
        }
        
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .match-card.completed {
            border-color: var(--success-green);
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }
        
        .match-card.scheduled {
            border-color: var(--info-cyan);
            background: linear-gradient(135deg, #ecfeff, #cffafe);
        }
        
        .team.winner {
            color: var(--success-green);
            font-weight: 700;
        }
        
        .team-score {
            font-size: 1.2rem;
            font-weight: 700;
            margin-left: 0.5rem;
        }
        
        .match-schedule, .match-result {
            background: rgba(255, 255, 255, 0.7);
            padding: 0.75rem;
            border-radius: 8px;
            margin: 0.5rem 0;
        }
        
        .schedule-item, .result-score, .winner-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }
        
        .score.winner {
            color: var(--success-green);
            font-weight: 700;
        }
        
        .score-separator {
            margin: 0 0.25rem;
            font-weight: 700;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .summary-item {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }
        
        .summary-label {
            display: block;
            font-size: 0.9rem;
            color: var(--medium-text);
            margin-bottom: 0.5rem;
        }
        
        .summary-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-text);
        }
        
        .summary-value.highlight {
            color: var(--primary-blue);
        }
        
        .reason-box {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--primary-blue);
            margin-top: 1rem;
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin: 1rem 0;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--medium-text);
        }
        
        .format-info {
            flex: 1;
        }
        
        .match-count {
            font-size: 0.9rem;
            color: var(--medium-text);
            display: flex;
            align-items: center;
            gap: 0.25rem;
            margin-top: 0.25rem;
        }
        
        .recommended-row {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }
        
        .table-responsive {
            overflow-x: auto;
        }
        
        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }
        
        .btn-outline-primary {
            background: transparent;
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
        }
        
        .btn-outline-primary:hover {
            background: var(--primary-blue);
            color: white;
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-badge.completed {
            background: var(--success-green);
            color: white;
        }
        
        .status-badge.in-progress {
            background: var(--warning-orange);
            color: var(--dark-text);
        }
        
        @media (max-width: 768px) {
            .summary-grid,
            .stats-grid,
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .bracket-meta {
                grid-template-columns: 1fr;
            }
            
            .matches-grid {
                grid-template-columns: 1fr;
            }
            
            .round-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .round-progress {
                width: 100%;
            }
            
            .notification {
                left: 1rem;
                right: 1rem;
                max-width: none;
            }
        }
    `;
    document.head.appendChild(style);
</script>
</body>
</html>
